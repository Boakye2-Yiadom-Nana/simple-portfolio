<%= render 'shared/navigation' %>

<div class="container">
  <div class="dashboard-header">
    <h1>My Skills Dashboard</h1>
    <%= link_to 'Add New Skill', new_skill_path, class: 'btn-primary' %>
  </div>

 <!-- Search & Filter Section -->
<div class="search-container">
  <%= form_with url: skills_path, method: :get, local: true, class: "search-form" do |form| %>
    <div class="form-group">
      <%= form.label :search, 'Search Skills:' %>
      <%= form.text_field :search, value: params[:search], placeholder: 'Enter skill name...' %>
    </div>
<div>
  <%= form.label :category_id, 'Filter by category' %>
  <%= form.collection_select :category_id, @categories, :id, :name, prompt: "Select a Category" %>
</div>

    <div class="form-group">
      <%= form.label :level, 'Filter by Level:' %>
      <%= form.select :level, options_for_select(
          [['All Levels', ''], 
           ['Beginner (1-3)', '1'], 
           ['Intermediate (4-6)', '4'], 
           ['Advanced (7-10)', '7']], 
          params[:level]) %>
    </div>

    <div class="form-actions">
      <%= form.submit 'Search', class: "btn btn-primary" %>
      <%= link_to 'Clear', skills_path, class: "btn btn-secondary" %>
    </div>
  <% end %>
</div>


  <!-- Stats -->
  <div class="stats">
    <div class="stat-card stat-total">
      <h3><%= @skills.count %></h3>
      <p>Total Skills</p>
    </div>
    <div class="stat-card stat-expert">
      <h3><%= @skills.where('level >= 8').count %></h3>
      <p>Expert Level</p>
    </div>
    <div class="stat-card stat-average">
      <h3><%= (@skills.average(:level) || 0).round(1) %></h3>
      <p>Average Level</p>
    </div>
  </div>

  <!-- Skills List -->
  <div>
    <% @skills.each do |skill| %>
         <% if skill.image.attached? %>
      <div style="flex-shrink: 0;">
        <%= image_tag skill.image, style: 'width: 100px; height: 100px; object-fit: cover; border-radius: 8px;' %>
      </div>
    <% end %>
      <div class="skill-card">
        <h3><%= skill.name %></h3>
        <p><strong>Level:</strong> <%= skill.level %>/10</p>
        <p><strong>Description:</strong> <%= skill.description %></p>

        <div>
          <%= link_to 'View', skill_path(skill), class: 'btn-view' %>
          <%= link_to 'Edit', edit_skill_path(skill), class: 'btn-edit' %>
          <%= link_to 'Delete', skill_path(skill),
              data: { turbo_method: :delete, turbo_confirm: 'Are you sure?' },
              class: 'btn-delete' %>
        </div>
      </div>
    <% end %>
  </div>
</div>
